packages:
  yum:
    mod24_ssl : []
    
files:
  /etc/httpd/conf.d/ssl.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      LoadModule ssl_module modules/mod_ssl.so
      Listen 443
      <VirtualHost *:443>
        <Proxy *>
          Order deny,allow
          Allow from all
        </Proxy>

        SSLEngine on
        SSLCertificateFile    "/etc/pki/tls/certs/server.crt"
        SSLCertificateKeyFile "/etc/pki/tls/certs/server.key"
        SSLCipherSuite        EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
        SSLProtocol           All -SSLv2 -SSLv3
        SSLHonorCipherOrder   On
        SSLSessionTickets     Off

        Header always set Strict-Transport-Security "max-age=63072000; includeSubdomains; preload"
        Header always set X-Frame-Options DENY
        Header always set X-Content-Type-Options nosniff
        
        ProxyPass / http://localhost:80/ retry=0
        ProxyPassReverse / http://localhost:80/
        ProxyPreserveHost on
        RequestHeader set X-Forwarded-Proto "https" early
      </VirtualHost>

  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIGMDCCBRigAwIBAgIJAObyYA9SApPJMA0GCSqGSIb3DQEBCwUAMIG0MQswCQYD
      VQQGEwJVUzEQMA4GA1UECBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEa
      MBgGA1UEChMRR29EYWRkeS5jb20sIEluYy4xLTArBgNVBAsTJGh0dHA6Ly9jZXJ0
      cy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5LzEzMDEGA1UEAxMqR28gRGFkZHkgU2Vj
      dXJlIENlcnRpZmljYXRlIEF1dGhvcml0eSAtIEcyMB4XDTIwMDMxOTEyNDIyNVoX
      DTIxMDMxOTEyNDIyNVowNzEhMB8GA1UECxMYRG9tYWluIENvbnRyb2wgVmFsaWRh
      dGVkMRIwEAYDVQQDEwlwaXhseS5hcHAwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
      ggEKAoIBAQCvNlCIPK9u0xB9p9gdWBZVpBUpKlt3GXvi/5a9YKtpZq1BbUc7Io5O
      kQ9IJNY+XGTi2bQWwgxELl/qSf5ri9Pzk0+wXRXp87DSDt2HDaKUBG0NkXhjEg/A
      L5FUNs8PGRUx4lQGxCc5FLZt3jAL72+ToSgCOckip0ZY6THNrCfzTu4ofE3kayDz
      nby7yMZAGUffgR/gWJMlFpPfLdJGp65jhg7yA4khxQkXkoNCtvES/pftVy2xKsj0
      X9nCQI2RuK2ZeM5QRg0sZB6lEYMIyhgGsrwhFegUoLAJ/PI436lhrmJXQYlSlTNM
      Kk7XHZUuswgZXSnuQh69Av+qCzdUa0tLAgMBAAGjggK/MIICuzAMBgNVHRMBAf8E
      AjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAOBgNVHQ8BAf8EBAMC
      BaAwOAYDVR0fBDEwLzAtoCugKYYnaHR0cDovL2NybC5nb2RhZGR5LmNvbS9nZGln
      MnMxLTE4MTEuY3JsMF0GA1UdIARWMFQwSAYLYIZIAYb9bQEHFwEwOTA3BggrBgEF
      BQcCARYraHR0cDovL2NlcnRpZmljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5
      LzAIBgZngQwBAgEwdgYIKwYBBQUHAQEEajBoMCQGCCsGAQUFBzABhhhodHRwOi8v
      b2NzcC5nb2RhZGR5LmNvbS8wQAYIKwYBBQUHMAKGNGh0dHA6Ly9jZXJ0aWZpY2F0
      ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS9nZGlnMi5jcnQwHwYDVR0jBBgwFoAU
      QMK9J47MNIMwojPX+2yz8LQsgM4wIwYDVR0RBBwwGoIJcGl4bHkuYXBwgg13d3cu
      cGl4bHkuYXBwMB0GA1UdDgQWBBSGBjOt8MGYIK9kvY8WMY18bbtZDzCCAQQGCisG
      AQQB1nkCBAIEgfUEgfIA8AB2AKS5CZC0GFgUh7sTosxncAo8NZgE+RvfuON3zQ7I
      DdwQAAABcPLQ+68AAAQDAEcwRQIgRHyDxtwLyoBhv5iAILfdaLV1Ykxp+tRFY5xg
      VaDRDsgCIQDu+2nPBsq2YqsWLzNozlc1SjFjsuU2jlBXh5nrV1x7rwB2AESUZS6w
      7s6vxEAH2Kj+KMDa5oK+2MsxtT/TM5a1toGoAAABcPLQ/fcAAAQDAEcwRQIhAKGo
      4zF2EPwsRKOm2h2vvZ2qGBiMsOVw+qDTOOcNHH/uAiBK/HESLkesRH1Ot9gmbwjf
      Io3DJE8qP1NeMV0jptB+aTANBgkqhkiG9w0BAQsFAAOCAQEAGNi1w1dJ88xmXYTc
      0RnCFwH0vLQ36WFy03t2SUfpy7Ndw/Q8mDxZ2JlsbyxxLlwaI7ybca3I+hoiw+eC
      NsgTgVu0ofYZKy/qQ4QrV7ZBfU8AfuCcoLMyXca5H4XEGqsyPlJAMz+mLn4B3Bi9
      J+JOOrJR7B1SAu6A2vIZrsz6wkvetumb4pnbEwsHr8zQqsl4kNUUIbzJUqfS9f9k
      +T69xVLbVHMxjSU+4pnQjSf4kUb3FiRH0xXhadSC3tk7m/G8d00tQ5L1nfbkXkHR
      LLWLnK9iUnS5il1FuCT0X+wWH5EK5v2cijTYhapmxfyUkm3PvWeQqp4Cg6beRFWD
      W2SsLA==
      -----END CERTIFICATE-----

  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEowIBAAKCAQEA0GTKYZKJAVTjhdGX+6y33esNlbKgzEjaTETAcY2umBBRFAGp
      zlWPVB0B8t1B6bkm8vjQlaaE2V4zFVPPXSLyoTiu9e8WmyimJy+ZCNsLmoDLFzQ6
      7JZG09t4frk2/ac4k99fbJPBirGA7/sTqc4VDV9dmo+PPf8UrD6PSpHOf90cHxvO
      vv1xp4TWTKhNr9uRuIWSl3VVDzZBvAKbQs7PXJl/7JTrZGNGV9LUATWKNysd9z1I
      /ZZvZBZOWiUiViyxQD4g+EYxyU6YkX/wI3yBlJ8fetTh05u+e2vgDrZWs8hFjyki
      4MVETPlS8JNT/nGxkcbYQ5g/6yZO/siUG7UrkwIDAQABAoIBADbSnS9IFoTkKSr2
      Na5/BKv7/0nngUfczpkL6Ti2Vj0o5buGqH5goeE19GJI9OMg029OJ8mG0iJBFt1A
      fCf7XqstN1H5wQ+2hOeALRlYTtgpk8QZ+HpvGlj3vt5PqXjXehnkxLzSrjLneY0o
      l0avsXggI4bax4s+xNh/aMDsVM/sCJ/UBAv1OJtUbpW2CiF1ZEC5T5hjt0mGvVNo
      cPo6ftNPyHXvEEIsfSuB7F5pdEw5uvR9WEsbqx5/Cdnjxhv8Hnsq4zAO2ctOuJ9h
      Fw02IZ1oseg84X6Fg13u2wetFIVpD1TLfM8R9k9EVwOj+BXzjvopJwvEnufEJT7S
      9iEw9ukCgYEA8vyWo+i53TV3C0DrrOxMF+sfz8yxVxbKlcj4LIWUk0v4tUyMh8pn
      wjlQmTTLOAqgHZ9Gz3mS12POjT2lJ6UYCHV8Hx/lzniKwkUPwPDDVuTdm7WRSeNx
      8SYhtz2q6oYeeMTumAx12djiyE2S5wFO1olk7O+cWLjJoKQx4vSsuP8CgYEA243s
      aNvbmn7WdGdbSOJVUbXLjmle7J+7K/v7n4GHuiy2S5ZI0/SL0mZMijtowFp0Hg1F
      cPieVvK4r4CVTS2BnASpLO+VeRDhPOJZ582LSbnzve61eCRTSjsMpLP/6YVKGziR
      vNC8NDG8cA76m/hYbe5wx4PcJbttGmfUjQJmmW0CgYEAs6CGvCUPQbiEiI01rGAC
      4KuwmK15bCgtGw22aTNW4o0HDv/H45p9mddE/f1JPeSc+UkFz9rP8uqVh1RLA0PI
      wHgZiejKuhfifDsRqlBSF6qZKMLQ5Q5+7QaDZjLwZu8/F4h92Wlcte7ft7OhJaSR
      44cuVPnNWslARMEdH+pAxYECgYAJ+SNxC/Ooy/Qv63YBFI7tnEV33Z97PjJBaDvg
      3gBtW5SYUGZUgnpLf2wgp1w1yKYXq2CpJhIDPxlWl4+wps2JacjJisSOcE7a9ilB
      V1vpaHIDAbHqmDPUXmRPowGP+QcJv4MXQaAa+ttld7i4lwplS/yBg6Lfb+kf1vGX
      yjEg7QKBgAheuNj6Igukyvm50izNOH1OCXuTOqwMcBmat3ait1IZi0VCrNEa29Jl
      NYb06fe1A3LnZgOe4PZMDgu4sPx0k7mxdPc446jPuOquEt883sHqJTCuwN+N6wRC
      ZHds+RwU7suqjtO8TLuO6u0enqkVYe/MCWYksfEojnQBm+iBwK8O
      -----END RSA PRIVATE KEY-----